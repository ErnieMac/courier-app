{"version":3,"sources":["./src/app/my-balance/my-balance-routing.module.ts","./src/app/my-balance/my-balance.module.ts","./src/app/my-balance/my-balance.page.ts","./src/app/my-balance/my-balance.page.scss","./src/app/my-balance/my-balance.page.html"],"names":[],"mappings":"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","file":"src_app_my-balance_my-balance_module_ts-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MyBalancePage } from './my-balance.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MyBalancePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MyBalancePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MyBalancePageRoutingModule } from './my-balance-routing.module';\n\nimport { MyBalancePage } from './my-balance.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    MyBalancePageRoutingModule\n  ],\n  declarations: [MyBalancePage]\n})\nexport class MyBalancePageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { BusinessPaymentService } from '../services/business-payment.service';\nimport { LoginService } from '../services/login.service';\nimport { Observable, EMPTY, of } from 'rxjs';\nimport { AlertController } from '@ionic/angular';\nimport { tap, catchError } from 'rxjs/operators';\n@Component({\n  selector: 'app-my-balance',\n  templateUrl: './my-balance.page.html',\n  styleUrls: ['./my-balance.page.scss'],\n})\nexport class MyBalancePage implements OnInit {\n  savedCards$: Observable<any>\n  account$: Observable<any>\n  user = this.loginService.currentUser.value\n  constructor(\n    private apiServices: BusinessPaymentService,\n    private loginService: LoginService,\n    public alertController: AlertController\n  ) { }\n\n  ngOnInit() {\n    let user = this.loginService.currentUser.value\n    this.savedCards$ = this.apiServices.get('retrieve-stored-card', 'businessId=' + user.userDetails.id).pipe(\n      tap((cards) => \"cards:\" + cards),\n      catchError((err) => {\n        return EMPTY;\n      })\n    );\n  }\n\n  ionViewWillEnter() {\n    let user = this.loginService.currentUser.value\n    this.savedCards$ = this.apiServices.get('retrieve-stored-card', 'businessId=' + user.userDetails.id).pipe(\n      tap((cards) => \"cards:\" + cards),\n      catchError((err) => {\n        return EMPTY;\n      })\n    );\n    this.savedCards$.subscribe(res => {\n      console.log(res)\n    })\n    this.getAccount()\n  }\n\n  getAccount() {\n    let user = this.loginService.currentUser.value\n    this.account$ = this.apiServices.get('retrieve-account', 'id=' + user.userDetails.id).pipe(\n      tap((account) => \"account:\" + account),\n      catchError((err) => {\n        return EMPTY;\n      })\n    );\n  }\n\n  handleCardDeletion(cardId) {\n    this.confirmDeletionAlert(cardId)\n  }\n\n  async confirmDeletionAlert(cardId) {\n    console.log(this.user.userDetails.id, cardId)\n    const alert = await this.alertController.create({\n      cssClass: 'danger-alert',\n      header: 'Confirm Deletion!',\n      message: 'Are you sure?',\n      buttons: [\n        {\n          text: 'No',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (blah) => {\n            console.log('No');\n          }\n        }, {\n          text: 'Yes',\n          handler: () => {\n            this.apiServices.delete('remove-stored-card', 'businessId=' + this.user.userDetails.id + '&cardId=' + cardId).subscribe(res => {\n              console.log(res)\n              this.savedCards$ = of(res)\n            }, error => {\n              console.log(error)\n            })\n          }\n        }\n      ]\n    });\n\n    await alert.present();\n  }\n\n}\n","export default \"ion-grid {\\n  padding: 10px;\\n}\\n\\n.card-blue {\\n  background: #1A6AE1 0% 0% no-repeat;\\n  box-shadow: 0px 10px 10px #0000001A;\\n  border-radius: 8px;\\n  opacity: 1;\\n}\\n\\n.heading-title {\\n  color: #FFFFFF;\\n  font-weight: 800;\\n  font-size: 20px;\\n  padding: 25px;\\n  line-height: 30px;\\n  float: left;\\n  width: 50%;\\n}\\n\\n.balance {\\n  padding: 40px 20px;\\n}\\n\\n.title {\\n  padding-left: 20px;\\n}\\n\\n.danger-alert {\\n  background: #00000033;\\n}\\n\\nion-card {\\n  margin: 10px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm15LWJhbGFuY2UucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUtBO0VBQ0ksYUFBQTtBQUpKOztBQU1BO0VBQ0ksbUNBQUE7RUFDQSxtQ0FBQTtFQUNBLGtCQUFBO0VBQ0EsVUFBQTtBQUhKOztBQU1BO0VBQ0ksY0FiVTtFQWNWLGdCQUFBO0VBQ0EsZUFBQTtFQUNBLGFBQUE7RUFDQSxpQkFBQTtFQUNBLFdBQUE7RUFDQSxVQUFBO0FBSEo7O0FBS0E7RUFDSSxrQkFBQTtBQUZKOztBQUlBO0VBQ0ksa0JBQUE7QUFESjs7QUFJQTtFQUNJLHFCQUFBO0FBREo7O0FBR0E7RUFDSSxZQUFBO0FBQUoiLCJmaWxlIjoibXktYmFsYW5jZS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDU1MgRG9jdW1lbnRzXG5cbiRibHVlLWNvbG9yOiAjMUE2QUUxO1xuJHdoaXRlLWNvbG9yOiAjRkZGRkZGO1xuXG5pb24tZ3JpZCB7XG4gICAgcGFkZGluZzogMTBweDtcbn1cbi5jYXJkLWJsdWUge1xuICAgIGJhY2tncm91bmQ6ICRibHVlLWNvbG9yIDAlIDAlIG5vLXJlcGVhdDtcbiAgICBib3gtc2hhZG93OiAwcHggMTBweCAxMHB4ICMwMDAwMDAxQTtcbiAgICBib3JkZXItcmFkaXVzOiA4cHg7XG4gICAgb3BhY2l0eTogMTtcbn1cblxuLmhlYWRpbmctdGl0bGUge1xuICAgIGNvbG9yOiAkd2hpdGUtY29sb3I7XG4gICAgZm9udC13ZWlnaHQ6IDgwMDtcbiAgICBmb250LXNpemU6IDIwcHg7XG4gICAgcGFkZGluZzogMjVweDtcbiAgICBsaW5lLWhlaWdodDogMzBweDtcbiAgICBmbG9hdDogbGVmdDtcbiAgICB3aWR0aDogNTAlO1xufVxuLmJhbGFuY2Uge1xuICAgIHBhZGRpbmc6IDQwcHggMjBweDtcbn1cbi50aXRsZSB7XG4gICAgcGFkZGluZy1sZWZ0OiAyMHB4O1xufVxuXG4uZGFuZ2VyLWFsZXJ0IHtcbiAgICBiYWNrZ3JvdW5kOiAjMDAwMDAwMzM7XG59XG5pb24tY2FyZCB7XG4gICAgbWFyZ2luOiAxMHB4O1xufSJdfQ== */\";","export default \"<ion-header [translucent]=\\\"true\\\">\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title class=\\\"title-android\\\">\\n      My account\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <ion-header collapse=\\\"condense\\\">\\n    <ion-toolbar>\\n      <ion-title size=\\\"large\\\" class=\\\"title-ios\\\">My account</ion-title>\\n    </ion-toolbar>\\n  </ion-header>\\n\\n  <ion-grid>\\n    <ion-row>\\n      <ion-col>\\n        <ion-segment value=\\\"My credit\\\">\\n          <ion-segment-button value=\\\"My credit\\\" [routerLink]=\\\"['/my-balance']\\\">\\n            <ion-label>My credit</ion-label>\\n          </ion-segment-button>\\n    \\n          <ion-segment-button value=\\\"Top up\\\" [routerLink]=\\\"['/top-up']\\\">\\n            <ion-label>Top up</ion-label>\\n          </ion-segment-button>\\n    \\n          <ion-segment-button value=\\\"Transactions\\\" [routerLink]=\\\"['/transaction-history']\\\">\\n            <ion-label>Transactions</ion-label>\\n          </ion-segment-button>\\n        </ion-segment>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n\\n  <ion-row>\\n    <ion-col>\\n      <ion-card class=\\\"card-blue\\\">\\n        <div class=\\\"heading-title\\\">My<br> Credit</div>\\n        <div *ngIf=\\\"!account$\\\" class=\\\"heading-title balance\\\">£0.00</div>\\n        <div *ngIf=\\\"account$ | async as account\\\" class=\\\"heading-title balance\\\">£{{account.total}}</div>\\n      </ion-card>\\n    </ion-col>\\n  </ion-row>\\n\\n  <ion-row>\\n    <ion-col>\\n      <label color=\\\"dark\\\">\\n        <h4 class=\\\"title\\\">Saved cards</h4>\\n      </label>\\n    </ion-col>\\n  </ion-row>\\n    \\n  <ion-row>\\n    <ion-col>\\n      <ion-list *ngIf=\\\"savedCards$ | async as cards\\\">\\n        <ion-item *ngFor=\\\"let card of cards\\\">\\n          <ion-icon slot=\\\"start\\\" name=\\\"card-outline\\\" color=\\\"primary\\\"></ion-icon>\\n          <ion-label>{{card.cardReference}}\\n          </ion-label>\\n          <ion-icon slot=\\\"end\\\" (click)=\\\"handleCardDeletion(card.cardId)\\\" name=\\\"trash-outline\\\" color=\\\"danger\\\">\\n          </ion-icon>\\n        </ion-item>\\n        <ion-item *ngIf=\\\"cards.length == 0\\\">\\n          <p>No saved card found</p>\\n        </ion-item>\\n      </ion-list>\\n      <ion-list *ngIf=\\\"!savedCards$ | async as cards\\\">\\n        <ion-item>\\n          Loading Saved Cards...\\n        </ion-item>\\n      </ion-list>\\n    </ion-col>\\n  </ion-row>\\n\\n  <ion-grid>\\n    <ion-row>\\n      <ion-col size=\\\"6\\\">\\n        <div>\\n          <ion-button type=\\\"submit\\\" expand=\\\"block\\\" fill=\\\"outline\\\" [routerLink]=\\\"['/recurring-payment']\\\">Recurring\\n          </ion-button>\\n        </div>\\n      </ion-col>\\n\\n      <ion-col size=\\\"6\\\">\\n        <div>\\n          <ion-button type=\\\"submit\\\" color=\\\"primary\\\" expand=\\\"block\\\" [routerLink]=\\\"['/add-card']\\\">Add card</ion-button>\\n        </div>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\";"],"sourceRoot":"webpack:///"}